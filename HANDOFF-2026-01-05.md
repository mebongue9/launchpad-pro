# HANDOFF DOCUMENT ‚Äî Launchpad Pro Corrections

**Session Date:** January 5, 2026
**Created By:** Claude Opus 4.5
**Purpose:** Hand off work to next terminal session

---

## WHEN REOPENING NEW TERMINAL, SAY THIS:

```
Read the handoff document at /Users/martinebongue/Desktop/claude code project 1/launchpad-pro/HANDOFF-2026-01-05.md and continue from where the previous session left off. FIX 5 needs verification, then proceed to FIX 2.
```

---

## PROJECT CONTEXT

**What we're fixing:** The Launchpad Pro app was built incorrectly by a previous AI session. We have a Vision document (`docs/LAUNCHPAD-PRO-VISION.md`) that describes the correct behavior, and a Correction document that identified 6 errors to fix.

**Correction Plan Location:** `~/.claude/plans/encapsulated-sparking-puddle.md`

---

## COMPLETED FIXES

### FIX 1: Move Generation to Lead Magnet Builder ‚úÖ COMPLETE + VERIFIED

**What was wrong:** FunnelBuilder.jsx was triggering 14-task content generation. It should only generate IDEAS (1 API call).

**What was fixed:**
- `src/pages/FunnelBuilder.jsx` ‚Äî Removed `useBatchedGeneration` import, now uses `generateFunnel()` from useFunnels (1 API call for ideas only)
- `src/pages/LeadMagnetBuilder.jsx` ‚Äî Already had `startGeneration()` for 14-task generation, updated header comments

**UX Fix Applied:** Changed button in LeadMagnetBuilder from "Save Lead Magnet" to "Generate Full Funnel" with Sparkles icon (supervisor requested this)

**Files Changed:**
- `src/pages/FunnelBuilder.jsx` (lines 1-4, 43-48, 156-191, 325-336)
- `src/pages/LeadMagnetBuilder.jsx` (lines 1-4, 207, 539-550)

**Verification Status:** ‚úÖ APPROVED by both code-execution-verifier and spec-compliance-verifier

---

### FIX 5: Embed Cross-Promo in Content ‚è≥ NEEDS VERIFICATION

**What was wrong:** Cross-promo was stored as separate `bridge_data` and `cta_data` columns. Should be a paragraph EMBEDDED in the last chapter of each product.

**What was fixed:**
- Added `main_product` to `getFunnelData()` query (fetches from `existing_product_id`)
- Added `buildCrossPromoParagraph()` helper function
- Updated 5 generator functions to embed cross-promo in last chapter instead of separate bridge/cta

**Cross-promo structure (CORRECTED):**
| Product | Cross-Promo Promotes | Where Embedded |
|---------|---------------------|----------------|
| Lead Magnet | Front-End | Chapter 5 |
| Front-End | Main Product | Chapter 6 |
| Bump | Main Product | Chapter 2 |
| Upsell 1 | Main Product | Chapter 6 |
| Upsell 2 | Main Product | Chapter 6 |

**mention_price handling:** Reads `main_product.mention_price` from database, defaults to `false` if not set

**Files Changed:**
- `netlify/functions/lib/batched-generators.js` (lines 1-8, 80-129, 238-328, 419-518, 520-609, 653-735, 778-861)

**Verification Status:** ‚è≥ NEEDS TO RUN code-execution-verifier and spec-compliance-verifier

---

## PENDING FIXES (In Order)

### FIX 2: Remove Format Selection from Visual Builder
**Status:** NOT STARTED
**What's wrong:** `src/pages/VisualBuilder.jsx` has manual format selection buttons. Format should come from funnel idea automatically.
**Files to modify:** `src/pages/VisualBuilder.jsx`

### FIX 3: Add Paste Option for Funnel Ideas
**Status:** NOT STARTED
**What's wrong:** FunnelBuilder has form fields for manual entry. Should have a text box where user can paste pre-formatted funnel ideas.
**Files to modify:** `src/pages/FunnelBuilder.jsx`, create `src/lib/funnel-parser.js`

**Paste formats to support:**
```
üí∞ FRONT-END: Product Name - Format ($17)
‚ö° BUMP: Product Name - Format ($9)
üöÄ UPSELL 1: Product Name - Format ($47)
üöÄ UPSELL 2: Product Name - Format ($67)
```
(Parser should work with or without emojis)

### FIX 6: Add Freshness Check for Funnel Ideas
**Status:** NOT STARTED
**What's wrong:** Only lead magnets check for excluded topics. Funnels should also check previous ideas.
**Files to modify:** `netlify/functions/generate-funnel.js`, `src/hooks/useFunnels.jsx`

### FIX 4: Add "Mention Price" Toggle to Products
**Status:** NOT STARTED
**What's wrong:** `ExistingProductForm.jsx` has TLDR and URL but no "Mention Price" checkbox.
**Files to modify:** `src/components/existing-products/ExistingProductForm.jsx`
**Database:** Add `mention_price` boolean column to `existing_products` table

---

## IMPORTANT NOTES FOR NEXT SESSION

1. **FIX 5 NEEDS VERIFICATION FIRST**
   - Run code-execution-verifier agent
   - Run spec-compliance-verifier agent
   - Only proceed to FIX 2 after APPROVED verdict

2. **One Fix at a Time**
   - Complete each fix fully before moving to next
   - Show BEFORE/AFTER code to user
   - Run verification agents
   - Get user approval before proceeding

3. **Cross-Promo is EMBEDDED, Not Separate**
   - No separate `bridge_data` or `cta_data` documents
   - Cross-promo is a paragraph at the END of the last chapter
   - Lead Magnet promotes Front-End
   - All paid products promote Main Product

4. **mention_price Comes from Database**
   - NO UI checkbox in Lead Magnet Builder
   - Read from `main_product.mention_price` in database
   - Defaults to `false` if column doesn't exist yet (FIX 4 adds the column)

5. **Old Funnels**
   - Leave existing funnels as-is
   - Only new funnels use the corrected flow

---

## KEY FILES REFERENCE

| File | Purpose |
|------|---------|
| `docs/LAUNCHPAD-PRO-VISION.md` | The correct behavior specification |
| `~/.claude/plans/encapsulated-sparking-puddle.md` | Full correction plan with all 6 fixes |
| `src/pages/FunnelBuilder.jsx` | Funnel IDEAS only (1 API call) |
| `src/pages/LeadMagnetBuilder.jsx` | Triggers ALL generation (14 tasks) |
| `netlify/functions/lib/batched-generators.js` | All 14 generation functions (cross-promo embedded) |
| `src/hooks/useFunnels.jsx` | Funnel CRUD + ideas generation |
| `src/hooks/useBatchedGeneration.jsx` | 14-task generation orchestration |

---

## VERIFICATION COMMANDS

To verify FIX 5, the next session should run:

```
Task(subagent_type='code-execution-verifier', prompt='Verify FIX 5 - cross-promo embedding in batched-generators.js')

Task(subagent_type='spec-compliance-verifier', prompt='Verify FIX 5 matches Vision spec: cross-promo embedded in last chapter, Lead Magnet promotes Front-End, paid products promote Main Product')
```

---

## WORKFLOW REMINDER

```
FunnelBuilder ‚Üí generateFunnel() ‚Üí 1 API call ‚Üí Returns IDEAS (names, prices, formats)
                    ‚Üì
           User saves funnel (status: 'draft')
                    ‚Üì
LeadMagnetBuilder ‚Üí User selects funnel ‚Üí generates lead magnet idea
                    ‚Üì
           User clicks "Generate Full Funnel" ‚Üí 14 tasks (all content with embedded cross-promo)
                    ‚Üì
VisualBuilder ‚Üí User selects style ‚Üí PDF generated (format auto-applied from funnel)
```

---

## SESSION SUMMARY

| Item | Status |
|------|--------|
| FIX 1: Move generation to Lead Magnet Builder | ‚úÖ COMPLETE + VERIFIED |
| FIX 1 UX: Button label change | ‚úÖ COMPLETE |
| FIX 5: Embed cross-promo in content | ‚úÖ CODE COMPLETE, ‚è≥ NEEDS VERIFICATION |
| FIX 2: Remove format selection | ‚è≥ PENDING |
| FIX 3: Add paste option | ‚è≥ PENDING |
| FIX 6: Add freshness check | ‚è≥ PENDING |
| FIX 4: Add mention_price toggle | ‚è≥ PENDING |

---

**END OF HANDOFF DOCUMENT**
